<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMM SERVICES - ORDER PANEL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #fdf6e3; font-family: 'Segoe UI', sans-serif; color: #1a1a1a; }
        .card { background: white; border: 3px solid #1a1a1a; border-radius: 20px; box-shadow: 8px 8px 0px #1a1a1a; }
        .btn-purple { background-color: #c4b5fd; border: 2px solid #1a1a1a; box-shadow: 4px 4px 0px #1a1a1a; transition: 0.2s; }
        .btn-purple:active { box-shadow: 0px 0px 0px #1a1a1a; transform: translate(4px, 4px); }
        .closed-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 1000; color: white; justify-content: center; align-items: center; flex-direction: column; text-align: center; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #1a1a1a; border-radius: 10px; }
    </style>
</head>
<body class="p-5">

    <div id="closedOverlay" class="closed-overlay">
        <div class="text-6xl mb-4">üõë</div>
        <h1 class="text-4xl font-black mb-2 uppercase text-white">Toko Tutup</h1>
        <p class="text-gray-400 font-bold italic">Lagi istirahat, Sheyya!</p>
    </div>

    <button onclick="toggleAdmin()" class="fixed bottom-4 left-4 bg-black text-white px-2 py-1 rounded text-[10px] opacity-20 hover:opacity-100 z-[2000]">ADMIN PANEL</button>

    <div class="max-w-md mx-auto">
        <div class="text-center mb-6">
            <span class="bg-[#c4b5fd] text-black px-4 py-1 rounded-full text-xs font-black border-2 border-black uppercase italic">SMM Services</span>
            <h1 class="text-3xl font-black mt-4 uppercase italic tracking-tighter">Order Panel</h1>
        </div>

        <div class="card p-6 mb-8">
            <div class="mb-4">
                <label class="block font-black text-xs mb-1 uppercase text-gray-400">Pilih Platform</label>
                <select id="categorySelect" onchange="updateServiceOptions()" class="w-full p-3 border-2 border-black rounded-xl font-bold bg-white outline-none">
                    <option value="">-- Pilih Platform --</option>
                </select>
            </div>

            <div class="mb-4">
                <label class="block font-black text-xs mb-1 uppercase text-gray-400">Pilih Paket</label>
                <select id="serviceSelect" onchange="calculatePrice()" class="w-full p-3 border-2 border-black rounded-xl font-bold bg-white outline-none">
                    <option value="">-- Pilih Jumlah --</option>
                </select>
            </div>

            <div class="grid grid-cols-2 gap-3 mb-6 text-center">
                <div class="border-2 border-black p-3 rounded-xl bg-yellow-100 font-black">
                    <p class="text-[10px] uppercase">Harga</p>
                    <p id="totalPriceDisplay" class="text-lg">Rp 0</p>
                </div>
                <div class="border-2 border-black p-3 rounded-xl bg-green-100 font-black">
                    <p class="text-[10px] uppercase">Status</p>
                    <p id="stockStatus" class="text-lg text-green-600 uppercase">READY</p>
                </div>
            </div>

            <div class="space-y-3">
                <input type="text" id="usernameTarget" placeholder="Username Target" class="w-full p-3 border-2 border-black rounded-xl font-bold outline-none">
                <input type="text" id="linkTarget" placeholder="Link / URL Target" class="w-full p-3 border-2 border-black rounded-xl font-bold outline-none">
                <div class="flex gap-2">
                    <input type="number" id="jumlahAwal" placeholder="Jml Awal" class="w-1/2 p-3 border-2 border-black rounded-xl font-bold outline-none">
                    <input type="text" id="redeemCode" onkeyup="calculatePrice()" placeholder="Kode Promo" class="w-1/2 p-3 border-2 border-black rounded-xl font-bold bg-purple-50 outline-none uppercase">
                </div>
                <div id="promoNotif" class="hidden text-[10px] font-black text-green-600 px-2 italic uppercase">Kupon Aktif!</div>
                <div class="p-3 border-2 border-black rounded-xl bg-indigo-100 flex justify-between items-center font-black text-xs">
                    <span>PAYMENT:</span>
                    <span class="text-indigo-700 italic">GOPAY ONLY</span>
                </div>
            </div>

            <button onclick="sendOrder()" id="btnOrder" class="btn-purple w-full mt-6 py-4 font-black text-xl rounded-xl uppercase">Order Sekarang</button>
        </div>

        <div id="adminPanel" class="hidden card p-6 bg-red-50 border-dashed mb-10 text-xs">
            <h2 class="font-black text-xl mb-4 text-red-600 uppercase italic">Admin Dashboard</h2>
            
            <div class="space-y-4">
                <div class="bg-white p-3 border-2 border-black rounded-xl">
                    <div class="flex justify-between items-center mb-2">
                        <p class="font-black uppercase italic text-gray-500">üìú Riwayat Order</p>
                        <button onclick="clearHistory()" class="text-[8px] bg-red-500 text-white px-2 py-1 rounded">CLEAR</button>
                    </div>
                    <div id="orderHistoryList" class="max-h-40 overflow-y-auto space-y-2 pr-1 italic"></div>
                </div>

                <div class="bg-white p-3 border-2 border-black rounded-xl">
                    <p class="font-black mb-2 uppercase italic text-gray-500">‚ûï Tambah Layanan</p>
                    <input type="text" id="addCat" placeholder="Platform" class="w-full mb-1 p-2 border-2 border-black rounded font-bold">
                    <input type="text" id="addPackage" placeholder="Paket" class="w-full mb-1 p-2 border-2 border-black rounded font-bold">
                    <input type="number" id="addPrice" placeholder="Harga" class="w-full mb-2 p-2 border-2 border-black rounded font-bold">
                    <button onclick="addNewService()" class="w-full bg-black text-white font-black py-2 rounded">SIMPAN</button>
                </div>

                <div class="bg-white p-3 border-2 border-black rounded-xl">
                    <p class="font-black mb-2 uppercase italic text-gray-500">üéüÔ∏è Redeem Code</p>
                    <div class="flex gap-2">
                        <input type="text" id="setPromoCode" placeholder="KODE" class="w-1/2 p-2 border-2 border-black rounded font-bold uppercase">
                        <input type="number" id="setPromoVal" placeholder="%" class="w-1/4 p-2 border-2 border-black rounded font-bold">
                        <button onclick="savePromo()" class="bg-indigo-600 text-white font-black px-2 rounded">SET</button>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <button onclick="toggleWebStatus()" id="btnWebStatus" class="font-black py-2 rounded border-2 border-black text-white italic"></button>
                    <button onclick="updateStockStatus()" id="btnStockStatus" class="bg-blue-500 text-white font-black py-2 rounded border-2 border-black italic">SET STOK</button>
                </div>

                <div class="bg-white p-3 border-2 border-black rounded-xl">
                    <p class="font-black mb-2 uppercase italic">Daftar Jualan:</p>
                    <div id="adminServiceList" class="max-h-32 overflow-y-auto space-y-1"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const WA_NUMBER = "62895324866749";
        const ADMIN_PASS = "sheyya221";

        const defaultData = {
            "whatsapp channel": [{n:"10 member",p:1000},{n:"100 member",p:10000},{n:"500 member",p:50000},{n:"1000 member",p:100000},{n:"2000 member",p:200000},{n:"3000 member",p:300000}],
            "tiktok followers": [{n:"100 followers",p:3950},{n:"500 followers",p:19750},{n:"1000 followers",p:39500},{n:"2000 followers",p:79000},{n:"3000 followers",p:118500},{n:"4000 followers",p:158000}],
            "instagram like": [{n:"100 like",p:1000},{n:"500 like",p:5000},{n:"1000 like",p:10000},{n:"2000 like",p:20000},{n:"3000 like",p:30000},{n:"4000 like",p:40000},{n:"5000 like",p:50000}],
            "instagram followers": [{n:"100 followers",p:5247},{n:"500 followers",p:26235},{n:"1000 followers",p:52470},{n:"2000 followers",p:104940},{n:"3000 followers",p:157410},{n:"4000 followers",p:209880}],
            "tiktok view": [{n:"100 view",p:30},{n:"500 view",p:150},{n:"1000 view",p:300},{n:"2000 view",p:600},{n:"3000 view",p:900},{n:"4000 view",p:1200},{n:"5000 view",p:1500}],
            "tiktok like": [{n:"100 like",p:550},{n:"500 like",p:2750},{n:"1000 like",p:5500},{n:"2000 like",p:11000},{n:"3000 like",p:16500},{n:"4000 like",p:27500}],
            "spotify followers": [{n:"100 followers",p:900},{n:"500 followers",p:4500},{n:"1000 followers",p:9000},{n:"2000 followers",p:18000},{n:"3000 followers",p:27000},{n:"4000 followers",p:36000}],
            "tiktok favorit/save": [{n:"100 favorit",p:20},{n:"500 favorit",p:100},{n:"1000 favorit",p:200},{n:"2000 favorit",p:400},{n:"3000 favorit",p:600},{n:"4000 favorit",p:800},{n:"5000 favorit",p:1000}],
            "facebook followers": [{n:"50 followers",p:489},{n:"100 followers",p:978},{n:"500 followers",p:4890},{n:"1000 followers",p:9780},{n:"2000 followers",p:19560},{n:"3000 followers",p:29340},{n:"4000 followers",p:39120},{n:"5000 followers",p:48900}],
            "twitter followers": [{n:"100 followers",p:2400},{n:"500 followers",p:12000},{n:"1000 followers",p:24000},{n:"2000 followers",p:48000},{n:"3000 followers",p:72000},{n:"4000 followers",p:96000},{n:"5000 followers",p:120000}],
            "youtube subscribers": [{n:"100 subscribers",p:800},{n:"500 subscribers",p:4000},{n:"1000 subscribers",p:8000},{n:"2000 subscribers",p:16000},{n:"3000 subscribers",p:24000},{n:"4000 subscribers",p:32000},{n:"5000 subscribers",p:40000}],
            "telegram public channel": [{n:"100 public",p:750},{n:"500 public",p:3750},{n:"1000 public",p:7500},{n:"2000 public",p:15000},{n:"3000 public",p:22000},{n:"4000 public",p:30000},{n:"5000 public",p:37000}],
            "instagram followers indo": [{n:"100 followers indo",p:8000},{n:"500 followers indo",p:16000},{n:"1000 followers indo",p:24000},{n:"2000 followers indo",p:40000},{n:"3000 followers indo",p:48000},{n:"4000 followers indo",p:56000},{n:"5000 followers indo",p:112000}],
            "tiktok view indo": [{n:"100 view indo",p:60},{n:"500 view indo",p:120},{n:"1000 view indo",p:180},{n:"2000 view indo",p:240},{n:"3000 view indo",p:300},{n:"4000 view indo",p:360},{n:"5000 view indo",p:420}]
        };

        let servicesData = JSON.parse(localStorage.getItem('servicesData')) || defaultData;
        let orderHistory = JSON.parse(localStorage.getItem('orderHistory')) || [];
        let isClosed = localStorage.getItem('webStatus') === 'closed';
        let globalStock = localStorage.getItem('globalStock') || "ready";
        let activePromo = JSON.parse(localStorage.getItem('activePromo')) || {code: "", val: 0};

        function init() {
            if(isClosed) document.getElementById('closedOverlay').style.display = 'flex';
            renderCategoryDropdown();
            renderAdminServiceList();
            renderHistory();
            updateUIStatus();
            document.getElementById('setPromoCode').value = activePromo.code;
            document.getElementById('setPromoVal').value = activePromo.val;
        }

        function renderCategoryDropdown() {
            const select = document.getElementById('categorySelect');
            select.innerHTML = '<option value="">-- Pilih Platform --</option>';
            Object.keys(servicesData).sort().forEach(cat => {
                let opt = document.createElement('option');
                opt.value = cat; opt.text = cat.toUpperCase();
                select.appendChild(opt);
            });
        }

        function updateServiceOptions() {
            const cat = document.getElementById('categorySelect').value;
            const select = document.getElementById('serviceSelect');
            select.innerHTML = '<option value="">-- Pilih Jumlah --</option>';
            if(servicesData[cat]) {
                servicesData[cat].forEach(s => {
                    let opt = document.createElement('option');
                    opt.value = s.p; opt.text = s.n;
                    select.appendChild(opt);
                });
            }
            calculatePrice();
        }

        function calculatePrice() {
            const price = parseInt(document.getElementById('serviceSelect').value) || 0;
            const inputPromo = document.getElementById('redeemCode').value.trim().toUpperCase();
            const notif = document.getElementById('promoNotif');
            let total = price;
            if(inputPromo === activePromo.code && activePromo.code !== "" && price > 0) {
                total = price - (price * (activePromo.val / 100));
                notif.classList.remove('hidden');
                notif.innerText = `Kupon ${activePromo.val}% Aktif!`;
            } else { notif.classList.add('hidden'); }
            document.getElementById('totalPriceDisplay').innerText = "Rp " + Math.floor(total).toLocaleString('id-ID');
        }

        function sendOrder() {
            if(globalStock === 'sold') return alert("Stok habis!");
            const cat = document.getElementById('categorySelect').value;
            const serv = document.getElementById('serviceSelect');
            const user = document.getElementById('usernameTarget').value;
            if(!cat || !serv.value || !user) return alert("Isi form dulu!");

            const serviceText = `${cat.toUpperCase()} ${serv.options[serv.selectedIndex].text}`;
            const finalPrice = document.getElementById('totalPriceDisplay').innerText;

            orderHistory.unshift({ service: serviceText, target: user, price: finalPrice, time: new Date().toLocaleString('id-ID') });
            localStorage.setItem('orderHistory', JSON.stringify(orderHistory));

            const format = `*ORDER SMM PANEL*\n` +
                           `username target : ${user}\n` +
                           `Link target : ${document.getElementById('linkTarget').value}\n` +
                           `Layanan : ${serviceText}\n` +
                           `Jumlah awal : ${document.getElementById('jumlahAwal').value || '0'}\n` +
                           `Payment : GOPAY ONLY\n` +
                           `Total : ${finalPrice}`;
            window.open(`https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(format)}`, '_blank');
            renderHistory();
        }

        function renderHistory() {
            const container = document.getElementById('orderHistoryList');
            container.innerHTML = orderHistory.length === 0 ? '<p class="text-gray-400">Belum ada orderan...</p>' : 
                orderHistory.map(h => `
                <div class="p-2 border-b border-gray-100 bg-gray-50 rounded mb-1">
                    <div class="flex justify-between font-black text-[8px] text-indigo-600"><span>${h.time}</span><span>${h.price}</span></div>
                    <div class="text-[9px]"><b>${h.service}</b> (${h.target})</div>
                </div>`).join('');
        }

        function clearHistory() { if(confirm("Hapus riwayat?")) { orderHistory = []; localStorage.setItem('orderHistory', "[]"); renderHistory(); } }

        function toggleAdmin() { if(prompt("Password:") === ADMIN_PASS) document.getElementById('adminPanel').classList.toggle('hidden'); }

        function addNewService() {
            const cat = document.getElementById('addCat').value.trim().toLowerCase();
            const pkg = document.getElementById('addPackage').value.trim();
            const price = parseInt(document.getElementById('addPrice').value);
            if(cat && pkg && price) {
                if(!servicesData[cat]) servicesData[cat] = [];
                servicesData[cat].push({n: pkg, p: price});
                localStorage.setItem('servicesData', JSON.stringify(servicesData));
                location.reload();
            }
        }

        function deleteService(cat, index) {
            servicesData[cat].splice(index, 1);
            if(servicesData[cat].length === 0) delete servicesData[cat];
            localStorage.setItem('servicesData', JSON.stringify(servicesData));
            location.reload();
        }

        function renderAdminServiceList() {
            const container = document.getElementById('adminServiceList');
            container.innerHTML = Object.keys(servicesData).map(cat => 
                servicesData[cat].map((s, i) => `
                <div class="flex justify-between bg-gray-100 p-1 mb-1 rounded">
                    <span>${cat}: ${s.n}</span>
                    <button onclick="deleteService('${cat}', ${i})" class="text-red-500 font-bold">X</button>
                </div>`).join('')).join('');
        }

        function savePromo() {
            activePromo = { code: document.getElementById('setPromoCode').value.toUpperCase(), val: parseInt(document.getElementById('setPromoVal').value) || 0 };
            localStorage.setItem('activePromo', JSON.stringify(activePromo));
            alert("Promo Terpasang!");
        }

        function toggleWebStatus() { localStorage.setItem('webStatus', isClosed ? 'open' : 'closed'); location.reload(); }
        function updateStockStatus() { globalStock = globalStock === 'ready' ? 'sold' : 'ready'; localStorage.setItem('globalStock', globalStock); updateUIStatus(); }

        function updateUIStatus() {
            document.getElementById('stockStatus').innerText = globalStock.toUpperCase();
            document.getElementById('stockStatus').className = `text-lg font-black ${globalStock === 'ready' ? 'text-green-600' : 'text-red-600'}`;
            const wsBtn = document.getElementById('btnWebStatus');
            wsBtn.innerText = isClosed ? 'BUKA TOKO' : 'TUTUP TOKO';
            wsBtn.className = `font-black py-2 rounded border-2 border-black ${isClosed ? 'bg-green-500' : 'bg-red-500'} text-white italic`;
        }

        init();
    </script>
</body>
</html>
